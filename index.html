<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Jones Bar WX Public Data</title>
  </head>
  <body>
    <h1>Jones Bar WX Public Data</h1>
    <ul>
      <li><a href="data/outdoor_conditions.json">outdoor_conditions.json</a></li>
      <li><a href="data/outdoor_conditions.csv">outdoor_conditions.csv</a></li>
    </ul>
	<div class="meta" id="status">
  		Files generated at: loading…<br>
  		Newest data timestamp: loading…
	</div>
    <p>Generated by a private publisher on a schedule.</p>

<script>
  function normalizeUtc(iso) {
    if (!iso) return null;

    // If it already has timezone info (Z or Â±hh:mm), leave it alone
    if (iso.endsWith("Z") || /[+-]\d\d:\d\d$/.test(iso)) return iso;

    // Otherwise assume it is UTC and append Z
    return iso + "Z";
  }

  function formatWithLocal(isoUtc) {
    if (!isoUtc) return "unavailable";

    const normalized = normalizeUtc(isoUtc);
    const d = new Date(normalized);
    if (isNaN(d.getTime())) return isoUtc + " UTC";

    const local = d.toLocaleString(undefined, {
      year: "numeric",
      month: "2-digit",
      day: "2-digit",
      hour: "2-digit",
      minute: "2-digit",
      second: "2-digit"
    });

    return (normalized.endsWith("Z") ? normalized : isoUtc) + " UTC (" + local + " local)";
  }

  fetch("data/outdoor_conditions.json")
    .then(r => r.json())
    .then(data => {
      const gen = formatWithLocal(data.generated_at_utc);
      const latest = formatWithLocal(data.latest_row_timestamp_utc);

      document.getElementById("status").innerHTML =
        "File generated at: " + gen + "<br>" +
        "Newest data timestamp: " + latest;
    })
    .catch(() => {
      document.getElementById("status").textContent = "Status: unable to load";
    });
</script>

<section>
  <h2>WHY</h2>
	  
<p>This project was built to explore reliable, low-maintenance data publishing for environmental observations. The focus was not on visualization,
	but on creating a predictable, inspectable data pipeline that mirrors how monitoring systems behave in production environments.
</p>
	
<h2>Design goals</h2>
<p>
Clear separation between private ingestion/storage and public outputs

Deterministic update schedules with visible timestamps

Formats suitable for downstream tools (e.g., scripts, Tableau, integrations)

Static delivery to reduce attack surface and operational complexity
</p>

	<b>The current implementation is intentionally simple and observable, with future iterations planned around validation, versioning, and expanded data products. </b>

	<h2>About this data</h2>

  <p>
    The data published here comes from a personal Davis weather station located
    at Jones Bar in Nevada County, California.
  </p>

  <p>
    Raw observations are fetched from the Davis WeatherLink API and stored locally
    in a private database. New readings are collected approximately every
    15 minutes.
  </p>

  <p>
    The files linked above are generated automatically from that database and
    updated on a regular schedule. They contain recent outdoor weather
    observations, currently covering the most recent 7 days of data.
  </p>

  <p>
    <strong>Published formats:</strong><br>
    JSON: machine-readable format suitable for APIs, scripts, and Tableau Web Data Connectors<br>
    CSV: spreadsheet-friendly format suitable for direct upload to Tableau Public
  </p>

  <p>
    This site serves static files only. The underlying system and database are not
    publicly accessible.
  </p>
</section>

  </body>
</html>
